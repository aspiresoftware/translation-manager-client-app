{"version":3,"sources":["library-dist.js"],"names":[],"mappings":"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","file":"library-dist.js","sourcesContent":["(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('redis-pubsub'), require('ainojs-ajax'), require('i18n-node')) :\n  typeof define === 'function' && define.amd ? define(['redis-pubsub', 'ainojs-ajax', 'i18n-node'], factory) :\n  global.TranslationManager = factory(global.Redispubsub, global.Ajax, global.i18n)\n}(this, function (Redispubsub, Ajax, i18n) { 'use strict';\n\n  /**\n   * @class\n   * An awesome script\n   */\n  class EventLogger {\n    static log(message) {\n      EventLogger.log(message);\n    }\n  }\n\n  var eventLogger = EventLogger;\n\n  class AjaxTranslationsLoader {\n    constructor(options, sucessCallback, failCallback) {\n      this.host = options.railsHost || '127.0.0.1';\n      this.port = options.railsPort || 3000;\n      this.restPath = options.restPath || AjaxTranslationsLoader.defaultPath;\n      this.storage = options.storage;\n      this.sucessCallback = sucessCallback;\n      this.failCallback = failCallback;\n      this.load();\n    }\n\n    static get defaultPath() {\n      return '/translations';\n    }\n\n    get request() {\n      return `'http://${this.host}:${this.port}/translations?${this.restPath}'`; // use String interpolation!\n    }\n\n    load() {\n      eventLogger.log('Ajax');\n      Ajax.get(this.request).then(function(data) {\n        eventLogger.log(data);\n      }).catch(function(data) {\n        eventLogger.log(data);\n      });\n    }\n  }\n\n  var ajaxTranslationsLoader = AjaxTranslationsLoader;\n\n  class TranslationsLoader {\n    constructor(options) {\n      this.locales = options.locales;\n      this.options = options;\n    }\n\n    load(locale, sucessCallback, failCallback) {\n      this.options.restPath = `locale=${locale}`;\n      return new ajaxTranslationsLoader(this.options, sucessCallback, failCallback);\n    }\n  }\n\n  var translationsLoader = TranslationsLoader;\n\n  class Internationalizer {\n    // constructor(options) {\n    //   // ??\n    // }\n\n    init(options) {\n      i18n.init(options);\n    }\n  }\n\n  var internationalizer = Internationalizer;\n\n  class StorageInternationalizer extends internationalizer {\n    init(resource) {\n      super.init(this.configurationFor(resource));\n    }\n\n    configurationFor(resource) {\n      return {resStore: resource};\n    }\n\n  }\n\n  var storageInternationalizer = StorageInternationalizer;\n\n  /**\n   * @class\n   * An awesome script\n   */\n  class Translator {\n    contructor(message) {\n      this.key = Object.keys(message)[0];\n      this.value = JSON.stringify(message[this.key]);\n    }\n\n    get locale() {\n      return localStorage.getItem(this.key);\n    }\n\n    get translation() {\n      return JSON.parse(this.locale);\n    }\n\n    // get resource() {\n    //   return {key: {translation: value}};\n    // }\n  }\n\n  var helpers_translator = Translator;\n\n  class TranslationSynchronizer {\n    constructor(options) {\n      this.storage = options.storage;\n    }\n\n    sync(message) {\n      var translator = new helpers_translator(message);\n      (new storageInternationalizer()).init(translator.resource());\n      this.dataKeys = Object.keys(message)[0];\n      this.storage.save(this.dataKeys, JSON.stringify(message[this.dataKeys]));\n    }\n  }\n\n  var translationSynchronizer = TranslationSynchronizer;\n\n  class EventBus {\n    constructor(options) {\n      this.eventLogger = new eventLogger(options);\n      this.translationSynchronizer = new translationSynchronizer(options);\n      this.channel = Redispubsub.createChannel(\n        options.realtimePort || 6379,\n        options.realtimeHost || '127.0.0.1',\n        options.channel || 'realtime_msg');\n      this.init();\n    }\n\n    init() {\n      var me = this;\n      this.channel.on('connect', function() {\n        me.channel.on('message', function(msg) {\n          me.eventLogger.log(msg.msg);\n          me.translationSynchronizer.sync(msg);\n        });\n      });\n    }\n  }\n\n  var eventBus = EventBus;\n\n  class TranslationManager {\n    constructor(options) {\n      this.options = options;\n      options.loader = new translationsLoader(options || {});\n      // this.storage = new LocaleStorage(options);\n      this.eventBus = new eventBus(options);\n    }\n  }\n\n  // export default TranslationManager;\n\n  return TranslationManager;\n\n}));\n"],"sourceRoot":"/source/"}