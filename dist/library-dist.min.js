function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _get=function(t,e,n){for(var o=!0;o;){var i=t,a=e,s=n;r=c=l=void 0,o=!1,null===i&&(i=Function.prototype);var r=Object.getOwnPropertyDescriptor(i,a);if(void 0!==r){if("value"in r)return r.value;var l=r.get;return void 0===l?void 0:l.call(s)}var c=Object.getPrototypeOf(i);if(null===c)return void 0;t=c,e=a,n=s,o=!0}},_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("redis-pubsub"),require("ainojs-ajax"),require("i18n-node")):"function"==typeof define&&define.amd?define(["redis-pubsub","ainojs-ajax","i18n-node"],e):t.MyLibrary=e(t.Redispubsub,t.Ajax,t.i18n)}(this,function(t,e,n){"use strict";var o=function(){function t(e,n,o){_classCallCheck(this,t),this.host=e.railsHost||"127.0.0.1",this.port=e.railsPort||3e3,this.restPath=e.restPath||t.defaultPath,this.storage=e.storage,this.sucessCallback=n,this.failCallback=o,this.load()}return _createClass(t,[{key:"load",value:function(){e.get(this.request).then(function(t){console.log(t)})["catch"](function(t){console.log(t)})}},{key:"request",get:function(){return"'http://"+this.host+":"+this.port+"/translations?"+this.restPath+"'"}}],[{key:"defaultPath",get:function(){return"/translations"}}]),t}(),i=o,a=function(){function t(e){_classCallCheck(this,t),this.locales=e.locales,this.options=e}return _createClass(t,[{key:"load",value:function(t,e,n){return this.options.restPath="locale="+t,new i(this.options,e,n)}}]),t}(),s=a,r=function(){function t(e){_classCallCheck(this,t),this.loader=e.loader||t.defaultLoader,this.initialize()}return _createClass(t,[{key:"initialize",value:function(){var t=!0,e=!1,n=void 0;try{for(var o,i=this.loader.locales[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;this.loader.load(a,this.sucessCallback,this.failCalllback)}}catch(s){e=!0,n=s}finally{try{!t&&i["return"]&&i["return"]()}finally{if(e)throw n}}}},{key:"sucessCallback",value:function(t){console.log("save"),this.save(Object.keys(t)[0],JSON.stringify(t[Object.keys(t)[0]]))}},{key:"failCalllback",value:function(t){console.log("fail"),console.log(t)}},{key:"save",value:function(t,e){window.localStorage.setItem(t,e),console.log("localStorage = "+t+" : "+e)}},{key:"load",value:function(t){window.localStorage.getItem(t)}}],[{key:"defaultLoader",get:function(){return new i({},this.sucessCallback,this.failCalllback)}}]),t}(),l=r,c=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"log",value:function(t){console.log(t)}}]),t}(),u=c,f=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"init",value:function(t){n.init(t)}}]),t}(),h=f,y=function(t){function e(){_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return _inherits(e,t),_createClass(e,[{key:"init",value:function(t){_get(Object.getPrototypeOf(e.prototype),"init",this).call(this,this.configurationFor(t))}},{key:"configurationFor",value:function(t){return{resStore:t}}}]),e}(h),g=y,k=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"contructor",value:function(t){this.key=Object.keys(t)[0],this.value=JSON.stringify(t[this.key])}},{key:"locale",get:function(){return localStorage.getItem(this.key)}},{key:"translation",get:function(){return JSON.parse(this.locale)}}]),t}(),v=k,p=function(){function t(e){_classCallCheck(this,t),this.storage=e.storage}return _createClass(t,[{key:"sync",value:function(t){var e=new v(t);(new g).init(e.resource()),this.storage.save(Object.keys(t)[0],JSON.stringify(t[Object.keys(t)[0]]))}}]),t}(),C=p,d=function(){function e(n){_classCallCheck(this,e),this.eventLogger=new u(n),this.translationSynchronizer=new C(n),this.channel=t.createChannel(n.realtimePort||6379,n.realtimeHost||"127.0.0.1",n.channel||"realtime_msg"),this.init()}return _createClass(e,[{key:"init",value:function(){var t=this;this.channel.on("connect",function(){t.channel.on("message",function(e){t.eventLogger.log(e.msg),t.translationSynchronizer.sync(e)})})}}]),e}(),b=d,_=function O(t){_classCallCheck(this,O),this.options=t,t.loader=new s(t||{}),this.storage=new l(t),this.logger=t.logger||console.log,this.eventBus=new b(t)},w=_;return w});
//# sourceMappingURL=library-dist.min.js.map