{"version":3,"sources":["library-dist.min.js","/source/library-dist.js"],"names":["_inherits","subClass","superClass","TypeError","prototype","Object","create","constructor","value","enumerable","writable","configurable","__proto__","_classCallCheck","instance","Constructor","_get","_x","_x2","_x3","_again","object","property","receiver","desc","parent","getter","undefined","Function","getOwnPropertyDescriptor","get","call","getPrototypeOf","_createClass","defineProperties","target","props","i","length","descriptor","defineProperty","key","protoProps","staticProps","global","factory","exports","module","require","define","amd","TranslationManager","Redispubsub","Ajax","i18n","this","EventLogger","message","log","eventLogger","AjaxTranslationsLoader","options","sucessCallback","failCallback","host","railsHost","port","railsPort","restPath","defaultPath","storage","load","request","then","data","ajaxTranslationsLoader","TranslationsLoader","locales","locale","translationsLoader","Internationalizer","init","internationalizer","StorageInternationalizer","_internationalizer","apply","arguments","resource","configurationFor","resStore","storageInternationalizer","Translator","keys","JSON","stringify","localStorage","getItem","parse","helpers_translator","TranslationSynchronizer","translator","dataKeys","save","translationSynchronizer","EventBus","channel","createChannel","realtimePort","realtimeHost","me","on","msg","sync","eventBus","loader"],"mappings":"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","file":"library-dist.min.js","sourcesContent":[null,"(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('redis-pubsub'), require('ainojs-ajax'), require('i18n-node')) :\n  typeof define === 'function' && define.amd ? define(['redis-pubsub', 'ainojs-ajax', 'i18n-node'], factory) :\n  global.TranslationManager = factory(global.Redispubsub, global.Ajax, global.i18n)\n}(this, function (Redispubsub, Ajax, i18n) { 'use strict';\n\n  /**\n   * @class\n   * An awesome script\n   */\n  class EventLogger {\n    static log(message) {\n      EventLogger.log(message);\n    }\n  }\n\n  var eventLogger = EventLogger;\n\n  class AjaxTranslationsLoader {\n    constructor(options, sucessCallback, failCallback) {\n      this.host = options.railsHost || '127.0.0.1';\n      this.port = options.railsPort || 3000;\n      this.restPath = options.restPath || AjaxTranslationsLoader.defaultPath;\n      this.storage = options.storage;\n      this.sucessCallback = sucessCallback;\n      this.failCallback = failCallback;\n      this.load();\n    }\n\n    static get defaultPath() {\n      return '/translations';\n    }\n\n    get request() {\n      return `'http://${this.host}:${this.port}/translations?${this.restPath}'`; // use String interpolation!\n    }\n\n    load() {\n      eventLogger.log('Ajax');\n      Ajax.get(this.request).then(function(data) {\n        eventLogger.log(data);\n      }).catch(function(data) {\n        eventLogger.log(data);\n      });\n    }\n  }\n\n  var ajaxTranslationsLoader = AjaxTranslationsLoader;\n\n  class TranslationsLoader {\n    constructor(options) {\n      this.locales = options.locales;\n      this.options = options;\n    }\n\n    load(locale, sucessCallback, failCallback) {\n      this.options.restPath = `locale=${locale}`;\n      return new ajaxTranslationsLoader(this.options, sucessCallback, failCallback);\n    }\n  }\n\n  var translationsLoader = TranslationsLoader;\n\n  class Internationalizer {\n    // constructor(options) {\n    //   // ??\n    // }\n\n    init(options) {\n      i18n.init(options);\n    }\n  }\n\n  var internationalizer = Internationalizer;\n\n  class StorageInternationalizer extends internationalizer {\n    init(resource) {\n      super.init(this.configurationFor(resource));\n    }\n\n    configurationFor(resource) {\n      return {resStore: resource};\n    }\n\n  }\n\n  var storageInternationalizer = StorageInternationalizer;\n\n  /**\n   * @class\n   * An awesome script\n   */\n  class Translator {\n    contructor(message) {\n      this.key = Object.keys(message)[0];\n      this.value = JSON.stringify(message[this.key]);\n    }\n\n    get locale() {\n      return localStorage.getItem(this.key);\n    }\n\n    get translation() {\n      return JSON.parse(this.locale);\n    }\n\n    // get resource() {\n    //   return {key: {translation: value}};\n    // }\n  }\n\n  var helpers_translator = Translator;\n\n  class TranslationSynchronizer {\n    constructor(options) {\n      this.storage = options.storage;\n    }\n\n    sync(message) {\n      var translator = new helpers_translator(message);\n      (new storageInternationalizer()).init(translator.resource());\n      this.dataKeys = Object.keys(message)[0];\n      this.storage.save(this.dataKeys, JSON.stringify(message[this.dataKeys]));\n    }\n  }\n\n  var translationSynchronizer = TranslationSynchronizer;\n\n  class EventBus {\n    constructor(options) {\n      this.eventLogger = new eventLogger(options);\n      this.translationSynchronizer = new translationSynchronizer(options);\n      this.channel = Redispubsub.createChannel(\n        options.realtimePort || 6379,\n        options.realtimeHost || '127.0.0.1',\n        options.channel || 'realtime_msg');\n      this.init();\n    }\n\n    init() {\n      var me = this;\n      this.channel.on('connect', function() {\n        me.channel.on('message', function(msg) {\n          me.eventLogger.log(msg.msg);\n          me.translationSynchronizer.sync(msg);\n        });\n      });\n    }\n  }\n\n  var eventBus = EventBus;\n\n  class TranslationManager {\n    constructor(options) {\n      this.options = options;\n      options.loader = new translationsLoader(options || {});\n      // this.storage = new LocaleStorage(options);\n      this.eventBus = new eventBus(options);\n    }\n  }\n\n  // export default TranslationManager;\n\n  return TranslationManager;\n\n}));\n"],"sourceRoot":"/source/"}